# bla-bla源码解读一

## 背景

今年年初以音频+社交模式诞生的Clubhouse受到资本和用户的热切追捧，引起了我的兴趣和关注。搞到邀请码后，上手一使用立刻感觉到它独特的魅力。极简的设计风格和live语音沟通的属性，有意无意间继承和发扬了许多成功app的独特优势：

1. 所有房间的对话都是实时发生的，这正符合live的属性。要是知道视频行业重录播到直播可是经历了好几年的变迁。Live为用户带来的是独特的现场感。

2. 房间不支持录音，app也努力做到禁止让用户录音。这和Snapchat阅后即焚的特性很吻合。这种形式，很好的减轻了用户分享的心理负担，毕竟不小心说错了一句话，被别人抓住把柄是件很麻烦的事情。阅后即焚，更能让用户畅所欲言。

3. 单向的following关系，正是Twitter以及微博成功的原因。这样的设计很容易因为头部用户的加入而带火整个社区。

如果说前面三点分别集成了Youtube，Snapchat，Twitter等个大app的优势。那么语音这种交互形式+轻量的加入和离开房间的形式更是成为了它独特的竞争优势，很好的还原了线下社交的场景：在线下社交时，不管是和一帮朋友小酌一杯还是参加各种交流会，大家主要都会以语音来传递信息。CH的设计都是以此为导向，比如它没有文字和图片功能，让大家的交流更集中在语言上；比如很好的音频通话质量；又比如轻量的加入和离开房间的方式。

另一方面，由于现在云计算平台的支持，做一款类似的app技术难度相对可以实现。

所以我们决定搞一搞。按照Clubhouse的功能为模版，经过两个月左右的开发，我们的网页版app已经很好的实现了多人多房间同时通话。同时每个用户在房间里边还可以举手、以文字的形式发言、点击reaction表情以及语音发言，用户的这些动作都能第一时间同步到同一个房间的所有其他用户。另外，由于浏览器的特殊性，app还能很好的handle用户刷新网页、关闭网页、同时打开多个网页访问相同地址等非常规操作。

受到声网小姐姐的邀请，准备接下来写一个系列的文章来讲解下bla-bla是如何实现这些操作的。

<!-- Todo: 插入两个视频链接 -->

## 文章结构

作为第一篇文章，我想先从整体上介绍下app的构成。另外，通过一个单向的用户流程：从登陆，加入房间，打开麦克风，离开房间来讲解下代码是如何实现的。

后面的文章会陆续讲解如何写服务端程序创建token，如何创建房间（包括预约房间），不同用户在同一房间里边的行为是如何同步的（比如观众阿涛举手，程序是如何让房间主人阿然看到举手，同时阿然是如何把阿涛邀请到台上，邀请到台上后，阿涛打开麦克风对观众讲话。这一系列的动作都需要数据在不同用户之间同步和传输）。

## 主体

## 结尾